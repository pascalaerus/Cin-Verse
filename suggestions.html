<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cin√©Verse | Suggestions</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<style>
:root {
  --primary-color: #e50914;
  --bg-dark: #0f0f0f;
  --card-bg: #1a1a1a;
  --input-bg: #333333;
  --text-light: #ffffff;
  --text-gray: #b3b3b3;
}
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family: 'Poppins', sans-serif; background-color: var(--bg-dark); color: var(--text-light); }
header { padding:20px; text-align:center; }
.tabs { display:flex; justify-content:center; margin-bottom:20px; gap:20px; }
.tab { padding:10px 20px; cursor:pointer; border-radius:5px; background:#222; transition:0.3s; }
.tab.active { background: var(--primary-color); }
.container { max-width:1200px; margin:0 auto; padding:0 15px; }
.grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:15px; margin-bottom:50px; }
.card { background: var(--card-bg); border-radius:10px; overflow:hidden; display:flex; flex-direction:column; border:1px solid #222; transition:0.3s; }
.card:hover { border-color: var(--primary-color); }
.card img { width:100%; height:350px; object-fit:cover; }
.card-content { padding:15px; flex:1; display:flex; flex-direction:column; justify-content:space-between; }
.card-content h3 { margin-bottom:10px; font-size:1.2rem; }
.card-content p { font-size:0.9rem; color:var(--text-gray); flex-grow:1; }
.card-content button { margin-top:10px; padding:10px; border:none; border-radius:5px; background: var(--primary-color); color:#fff; cursor:pointer; transition:0.3s; }
.card-content button:hover { opacity:0.9; }
#ngl-btn { display:block; text-align:center; margin:20px auto; padding:10px 20px; background:#25D366; color:#fff; border-radius:5px; text-decoration:none; font-weight:600; }
</style>
</head>
<body>

<header>
  <h1>Cin√©Verse | Suggestions</h1>
  <p>D√©couvrez les films et s√©ries populaires et faites vos demandes !</p>
</header>

<div class="tabs">
  <div class="tab active" data-type="movie">Films Populaires</div>
  <div class="tab" data-type="tv">S√©ries Populaires</div>
</div>

<div class="container">
  <div id="suggestionsGrid" class="grid"></div>
</div>

<a href="https://ngl.link/pascal_aerus22519" id="ngl-btn" target="_blank"><i class="fas fa-user-secret"></i> Suggestions anonymes</a>

<script>
// EmailJS Init
emailjs.init("nwNk-9LbyO0XHfwql");

// TMDB API
const TMDB_API_KEY = "343afb1d4a8c081ad737a2aef2f96d9a";
let currentType = "movie";
let currentPage = 1;
const grid = document.getElementById("suggestionsGrid");

// Charger les suggestions
async function loadSuggestions(type, page=1){
    const res = await fetch(`https://api.themoviedb.org/3/${type}/popular?api_key=${TMDB_API_KEY}&language=fr&page=${page}`);
    const data = await res.json();
    data.results.forEach(item => {
        const title = type === "movie" ? item.title : item.name;
        const overview = item.overview || "Pas de r√©sum√© disponible.";
        const seasons = item.number_of_seasons || 1;

        const card = document.createElement("div");
        card.className = "card";

        card.innerHTML = `
            <img src="https://image.tmdb.org/t/p/w500${item.poster_path}" alt="${title}">
            <div class="card-content">
                <h3>${title}</h3>
                <p>${overview}</p>
                <button onclick="requestContent('${title}','${type}','${seasons}')">Demander ce ${type==='movie'?'film':'s√©rie'}</button>
            </div>
        `;
        grid.appendChild(card);
    });
}

// Bouton onglets
document.querySelectorAll(".tab").forEach(tab => {
    tab.addEventListener("click", ()=>{
        document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
        tab.classList.add("active");
        currentType = tab.dataset.type;
        currentPage = 1;
        grid.innerHTML = "";
        loadSuggestions(currentType,currentPage);
    });
});

// Scroll infini
window.addEventListener("scroll", ()=>{
    if(window.innerHeight + window.scrollY >= document.body.offsetHeight - 500){
        currentPage++;
        loadSuggestions(currentType,currentPage);
    }
});

// Fonction demander film/s√©rie
function requestContent(title,type,seasons){
    // V√©rification s√©rie >3 saisons
    if(type==="tv" && seasons>3){
        const code = prompt("Cette s√©rie a plus de 3 saisons, code premium requis :");
        if(code !== "AMIDEPASCAL"){
            alert("DEMANDE REJET√âE : Vous n'√™tes pas Premium !");
            return;
        }
    }

    const name = prompt("Votre nom:");
    const email = prompt("Votre email:");
    if(!name || !email){ alert("Nom et email requis"); return; }

    // Message WhatsApp
    const phone = "22996326185";
    const message = `üé¨ *NOUVELLE DEMANDE CIN√âVERSE* üé¨%0A%0A`+
                    `üë§ *Nom:* ${name}%0A`+
                    `üìå *Type:* ${type==='movie'?'Film':'S√©rie'}%0A`+
                    `üéûÔ∏è *Titre:* ${title}%0A%0A`+
                    `_Demande effectu√©e depuis le site web._`;
    window.open(`https://wa.me/${phone}?text=${message}`,'_blank');

    // Envoi mail EmailJS
    emailjs.send("service_7njbqib","template_dzcv9gj",{
        user_name:name,
        user_email:email,
        content_title:title,
        content_type:type==='movie'?'Film':'S√©rie',
        seasons:seasons,
        status:"Demande re√ßue !"
    });

    alert("‚úÖ Votre demande a √©t√© envoy√©e et un mail de confirmation vous a √©t√© envoy√© !");
}

// Charger au d√©part
loadSuggestions(currentType,currentPage);
</script>

</body>
</html>