<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cin√©Verse | Films, S√©ries & Mangas</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<style>
:root {
    --primary-color: #e50914;
    --bg-dark: #0f0f0f;
    --card-bg: #1a1a1a;
    --input-bg: #333333;
    --text-light: #ffffff;
    --text-gray: #b3b3b3;
}
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family: 'Poppins', sans-serif; background-color: var(--bg-dark); color: var(--text-light); line-height:1.6; }

header {
    height: 35vh;
    background: linear-gradient(rgba(0,0,0,0.8), rgba(15,15,15,1)), 
                url('https://images.unsplash.com/photo-1489599849927-2ee91cede3ba?auto=format&fit=crop&w=1350&q=80');
    background-size: cover; background-position: center;
    display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center;
}
.logo { font-size:3rem; font-weight:700; color: var(--primary-color); text-transform:uppercase; letter-spacing:2px; }
.container { max-width:900px; margin:-40px auto 50px; padding:0 20px; }
.section-title { text-align:center; margin:40px 0 20px; font-size:1.6rem; color: var(--text-light); border-left:4px solid var(--primary-color); padding-left:10px; display:inline-block; }
.box { background: var(--card-bg); padding:30px; border-radius:15px; margin-bottom:30px; border:1px solid #222; }
.form-group { margin-bottom:15px; }
.form-group label { display:block; margin-bottom:5px; color: var(--text-gray); font-size:0.9rem; }
.form-group input, .form-group select { width:100%; padding:12px; border-radius:5px; border:1px solid #444; background: var(--input-bg); color:white; font-family:inherit; }
#promo-field { display:none; margin-top:15px; border:1px dashed var(--primary-color); padding:10px; border-radius:5px; }
.btn { display:inline-block; padding:12px 25px; background: var(--primary-color); color:white; text-decoration:none; border-radius:5px; font-weight:600; margin-top:10px; transition:0.3s; border:none; cursor:pointer; width:100%; text-align:center; }
.btn:hover { opacity:0.9; }
.contact-links { display:flex; flex-wrap:wrap; justify-content:center; gap:20px; margin-top:20px; }
.contact-item { color: var(--text-gray); text-decoration:none; transition:0.3s; font-size:0.9rem; display:flex; align-items:center; gap:8px; }
.contact-item:hover { color: var(--primary-color); }
footer { text-align:center; padding:40px; color: var(--text-gray); font-size:0.8rem; border-top:1px solid #222; margin-top:50px; }
</style>
</head>
<body>

<header>
<div class="logo">Cin√©Verse</div>
<p>Demandez vos films et s√©ries pr√©f√©r√©s</p>
</header>

<div class="container">

<h2 class="section-title">Faire une demande</h2>
<div class="box">
<form id="movieForm">
<div class="form-group">
    <label>Votre Nom</label>
    <input type="text" id="user_name" placeholder="Ex: Jean" required>
</div>

<div class="form-group">
    <label>Votre Email</label>
    <input type="email" id="user_email" placeholder="Ex: jean@gmail.com" required>
</div>

<div class="form-group">
    <label>Type de contenu</label>
    <select id="content_type">
        <option value="Film">Film</option>
        <option value="S√©rie">S√©rie</option>
    </select>
</div>

<div class="form-group">
    <label>Titre (Nom exact)</label>
    <input type="text" id="movie_name" placeholder="Ex: John Wick, Stranger Things..." required>
</div>

<div class="form-group" id="season-field" style="display:none;">
    <label>Saison</label>
    <select id="season_select"></select>
</div>

<div id="promo-field">
    <label style="color:#ffcc00;"><i class="fas fa-key"></i> Code Promo Premium Requis</label>
    <input type="text" id="promo_code" placeholder="Entrez votre code ici">
    <small style="color:#b3b3b3;">Les s√©ries de plus de 3 saisons sont r√©serv√©es aux membres Premium.</small>
</div>

<button type="button" id="submit_request" class="btn" style="background:#25D366;margin-top:20px;">
    <i class="fab fa-whatsapp"></i> Envoyer ma demande
</button>
</form>
</div>

<div class="contact-links">
    <a href="mailto:pascal270305@gmail.com" class="contact-item"><i class="fas fa-envelope"></i> pascal270305@gmail.com</a>
    <a href="https://www.facebook.com/PascalA√©rus" class="contact-item" target="_blank"><i class="fab fa-facebook"></i> Pascal A√©rus</a>
</div>

</div>

<footer>
<p>&copy; 2026 Cin√©Verse | Cr√©√© par Pascal A√©rus</p>
</footer>

<script>
// EmailJS Init
emailjs.init("nwNk-9LbyO0XHfwql");

// TMDB API key
const TMDB_API_KEY = "343afb1d4a8c081ad737a2aef2f96d9a";

// V√©rifie type et saisons
async function checkContentType(title){
    // Cherche films
    let res = await fetch(`https://api.themoviedb.org/3/search/movie?api_key=${TMDB_API_KEY}&query=${encodeURIComponent(title)}&language=fr`);
    let data = await res.json();
    if(data.results && data.results.length>0) return {type:"Film", seasons:1};

    // Cherche s√©ries
    res = await fetch(`https://api.themoviedb.org/3/search/tv?api_key=${TMDB_API_KEY}&query=${encodeURIComponent(title)}&language=fr`);
    data = await res.json();
    if(data.results && data.results.length>0){
        const tv = data.results[0];
        const detailRes = await fetch(`https://api.themoviedb.org/3/tv/${tv.id}?api_key=${TMDB_API_KEY}&language=fr`);
        const detailData = await detailRes.json();
        return {type:"S√©rie", seasons:detailData.number_of_seasons || 1};
    }

    return {type:"Inconnu", seasons:0};
}

// Affiche saison et promo
function toggleSeasonAndPromo(result, selectedType){
    const seasonDiv = document.getElementById("season-field");
    const seasonSelect = document.getElementById("season_select");
    const promoDiv = document.getElementById("promo-field");

    if(result.type === "S√©rie" && selectedType==="S√©rie"){
        seasonDiv.style.display = "block";
        seasonSelect.innerHTML = "";
        for(let i=1; i<=result.seasons; i++){
            const opt = document.createElement("option");
            opt.value = i; opt.textContent = `Saison ${i}`;
            seasonSelect.appendChild(opt);
        }
        promoDiv.style.display = result.seasons>3 ? "block" : "none";
    } else {
        seasonDiv.style.display = "none";
        promoDiv.style.display = "none";
    }
}

// Bouton demande
document.getElementById("submit_request").addEventListener("click", async function(){
    const name = document.getElementById("user_name").value.trim();
    const email = document.getElementById("user_email").value.trim();
    const type = document.getElementById("content_type").value;
    const title = document.getElementById("movie_name").value.trim();
    const code = document.getElementById("promo_code").value.trim();
    const season = document.getElementById("season_select").value;

    if(!name || !email || !title){
        alert("Veuillez remplir tous les champs !");
        return;
    }

    const result = await checkContentType(title);

    if(result.type==="Inconnu"){
        alert(`‚ùå Erreur : "${title}" n'a pas √©t√© trouv√© sur TMDB.`);
        return;
    }

    if(type !== result.type){
        alert(`‚ùå Erreur : "${title}" est un ${result.type}, pas une ${type}.`);
        return;
    }

    toggleSeasonAndPromo(result, type);

    if(result.type==="S√©rie" && result.seasons>3 && code!=="AMIDEPASCAL"){
        alert("DEMANDE REJET√âE : Vous n'√™tes pas Premium !");
        return;
    }

    // WhatsApp
    const phone = "22996326185";
    let message = `üé¨ *NOUVELLE DEMANDE CIN√âVERSE* üé¨%0A%0A`+
                  `üë§ *Nom:* ${name}%0A`+
                  `üìå *Type:* ${type}%0A`+
                  `üéûÔ∏è *Titre:* ${title}%0A`+
                  (type==="S√©rie"?`üé¨ *Saison:* ${season}%0A`:"")+
                  (code==="AMIDEPASCAL"?`üîë *Code:* ${code} (V√âRIFI√â ‚úÖ)%0A`:"")+
                  `%0A_Demande effectu√©e depuis le site web._`;
    window.open(`https://wa.me/${phone}?text=${message}`,'_blank');

    // EmailJS
    emailjs.send("service_7njbqib","template_dzcv9gj",{
        user_name:name,
        user_email:email,
        content_title:title,
        content_type:type,
        season:season,
        status:"Demande re√ßue !"
    });

    alert("‚úÖ Votre demande a √©t√© envoy√©e et un mail de confirmation vous a √©t√© envoy√© !");
});

// Met √† jour la saison quand on change le type
document.getElementById("content_type").addEventListener("change", async function(){
    const type = this.value;
    const title = document.getElementById("movie_name").value.trim();
    if(title) {
        const result = await checkContentType(title);
        toggleSeasonAndPromo(result, type);
    }
});
</script>

</body>
</html>