<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cin√©Verse | Films, S√©ries & Mangas</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- EmailJS -->
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<style>
:root {
    --primary-color: #e50914;
    --bg-dark: #0f0f0f;
    --card-bg: #1a1a1a;
    --input-bg: #333333;
    --text-light: #ffffff;
    --text-gray: #b3b3b3;
}
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family: 'Poppins', sans-serif; background-color: var(--bg-dark); color: var(--text-light); line-height:1.6; }

header {
    height: 35vh;
    background: linear-gradient(rgba(0,0,0,0.8), rgba(15,15,15,1)), 
                url('https://images.unsplash.com/photo-1489599849927-2ee91cede3ba?auto=format&fit=crop&w=1350&q=80');
    background-size: cover; background-position: center;
    display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center;
}

.logo { font-size:3rem; font-weight:700; color: var(--primary-color); text-transform:uppercase; letter-spacing:2px; }

.container { max-width:900px; margin:-40px auto 50px; padding:0 20px; }
.section-title { text-align:center; margin:40px 0 20px; font-size:1.6rem; color: var(--text-light); border-left:4px solid var(--primary-color); padding-left:10px; display:inline-block; }

.grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:15px; margin-bottom:40px; }
.card { background: var(--card-bg); padding:25px; border-radius:15px; text-align:center; transition:0.3s; border:1px solid #222; }
.card:hover { transform:translateY(-5px); border-color: var(--primary-color); }
.card i { font-size:2.5rem; margin-bottom:15px; }

.btn { display:inline-block; padding:12px 25px; background: var(--primary-color); color:white; text-decoration:none; border-radius:5px; font-weight:600; margin-top:10px; transition:0.3s; border:none; cursor:pointer; width:100%; text-align:center; }
.btn:hover { opacity:0.9; }

.box { background: var(--card-bg); padding:30px; border-radius:15px; margin-bottom:30px; border:1px solid #222; }
.form-group { margin-bottom:15px; }
.form-group label { display:block; margin-bottom:5px; color: var(--text-gray); font-size:0.9rem; }
.form-group input, .form-group select { width:100%; padding:12px; border-radius:5px; border:1px solid #444; background: var(--input-bg); color:white; font-family:inherit; }

#promo-field { display:none; margin-top:15px; border:1px dashed var(--primary-color); padding:10px; border-radius:5px; }

.contact-links { display:flex; flex-wrap:wrap; justify-content:center; gap:20px; margin-top:20px; }
.contact-item { color: var(--text-gray); text-decoration:none; transition:0.3s; font-size:0.9rem; display:flex; align-items:center; gap:8px; }
.contact-item:hover { color: var(--primary-color); }

footer { text-align:center; padding:40px; color: var(--text-gray); font-size:0.8rem; border-top:1px solid #222; margin-top:50px; }
</style>
</head>
<body>

<header>
<div class="logo">Cin√©Verse</div>
<p>Demandez vos films et s√©ries pr√©f√©r√©s</p>
</header>

<div class="container">

<h2 class="section-title">Rejoindre les Groupes</h2>
<div class="grid">
    <div class="card">
        <i class="fab fa-whatsapp" style="color:#25D366;"></i>
        <h3>Films & S√©ries</h3>
        <a href="https://chat.whatsapp.com/KUrZRWKL7CpDn6zwXUcEgm?mode=gi_t" class="btn" target="_blank">Rejoindre</a>
    </div>
    <div class="card">
        <i class="fab fa-whatsapp" style="color:#25D366;"></i>
        <h3>Mangas</h3>
        <a href="https://chat.whatsapp.com/BdCsIhDN0JGIDKXndF04Qv?mode=gi_t" class="btn" target="_blank">Rejoindre</a>
    </div>
    <div class="card">
        <i class="fab fa-telegram" style="color:#0088cc;"></i>
        <h3>Telegram</h3>
        <a href="https://t.me/filmsetseriescineverse" class="btn" target="_blank">S'abonner</a>
    </div>
</div>

<h2 class="section-title">Faire une demande</h2>
<div class="box">
<form id="movieForm">
<div class="form-group">
    <label>Votre Nom</label>
    <input type="text" id="user_name" placeholder="Ex: Jean" required>
</div>

<div class="form-group">
    <label>Votre Email</label>
    <input type="email" id="user_email" placeholder="Ex: jean@gmail.com" required>
</div>

<div class="form-group">
    <label>Type de contenu</label>
    <select id="content_type">
        <option value="Film">Film</option>
        <option value="S√©rie">S√©rie</option>
        <option value="Manga">Manga</option>
    </select>
</div>

<div class="form-group">
    <label>Titre (Nom exact)</label>
    <input type="text" id="movie_name" placeholder="Ex: John Wick, Prison Break..." required>
</div>

<div id="promo-field">
    <label style="color:#ffcc00;"><i class="fas fa-key"></i> Code Promo Premium Requis</label>
    <input type="text" id="promo_code" placeholder="Entrez votre code ici">
    <small style="color:#b3b3b3;">Les s√©ries de plus de 3 saisons sont r√©serv√©es aux membres Premium.</small>
</div>

<button type="button" id="submit_request" class="btn" style="background:#25D366;margin-top:20px;">
    <i class="fab fa-whatsapp"></i> Envoyer ma demande
</button>

<button type="button" id="view_requests" class="btn" style="background:#ffcc00;margin-top:20px;">
    Mes demandes
</button>
</form>
</div>

<div class="contact-links">
    <a href="https://wa.me/22996326185" class="contact-item" target="_blank"><i class="fab fa-whatsapp"></i> +229 96 32 61 85</a>
    <a href="https://t.me/unknown270305" class="contact-item" target="_blank"><i class="fab fa-telegram"></i> @unknown270305</a>
    <a href="mailto:pascal270305@gmail.com" class="contact-item"><i class="fas fa-envelope"></i> pascal270305@gmail.com</a>
    <a href="https://www.facebook.com/PascalA√©rus" class="contact-item" target="_blank"><i class="fab fa-facebook"></i> Pascal A√©rus</a>
</div>

</div>

<footer>
<p>&copy; 2026 Cin√©Verse | Cr√©√© par Pascal A√©rus</p>
</footer>

<script>
// EmailJS Init
emailjs.init("nwNk-9LbyO0XHfwql");

// TMDB API key
const TMDB_API_KEY = "343afb1d4a8c081ad737a2aef2f96d9a";

// V√©rifie le type et saisons via TMDB
async function checkContentType(title){
    try {
        let res = await fetch(`https://api.themoviedb.org/3/search/tv?api_key=${TMDB_API_KEY}&query=${encodeURIComponent(title)}&language=fr`);
        let data = await res.json();
        if(data.results && data.results.length>0){
            const tv = data.results[0];
            const detailRes = await fetch(`https://api.themoviedb.org/3/tv/${tv.id}?api_key=${TMDB_API_KEY}&language=fr`);
            const detailData = await detailRes.json();
            const seasons = detailData.number_of_seasons || 1;
            return {type:"S√©rie", seasons:seasons};
        }

        res = await fetch(`https://api.themoviedb.org/3/search/movie?api_key=${TMDB_API_KEY}&query=${encodeURIComponent(title)}&language=fr`);
        data = await res.json();
        if(data.results && data.results.length>0) return {type:"Film", seasons:1};

        return {type:"Inconnu", seasons:0};
    } catch(e){
        console.error("Erreur API TMDB:", e);
        return {type:"Inconnu", seasons:0};
    }
}

function togglePromoField(seasons){
    const promoDiv = document.getElementById("promo-field");
    promoDiv.style.display = seasons>3 ? "block" : "none";
}

function saveRequestLocally(request){
    let existing = JSON.parse(localStorage.getItem("cinverse_requests") || "[]");
    existing.push(request);
    localStorage.setItem("cinverse_requests", JSON.stringify(existing));
}

function showRequests(){
    let existing = JSON.parse(localStorage.getItem("cinverse_requests") || "[]");
    if(existing.length===0){
        alert("üì≠ Vous n'avez fait aucune demande pour le moment !");
        return;
    }
    let msg = "üìã Vos demandes :\n\n";
    existing.forEach((r,i)=>{
        msg += `${i+1}. ${r.title} (${r.type}) - ${r.seasons} saisons\n`;
    });
    alert(msg);
}

document.getElementById("submit_request").addEventListener("click", async function(){
    const name = document.getElementById("user_name").value.trim();
    const email = document.getElementById("user_email").value.trim();
    const type = document.getElementById("content_type").value;
    const title = document.getElementById("movie_name").value.trim();
    const code = document.getElementById("promo_code").value.trim();

    if(!name || !email || !title){
        alert("Veuillez remplir tous les champs !");
        return;
    }

    const result = await checkContentType(title);

    if(result.type==="Inconnu"){
        alert(`‚ùå Erreur : "${title}" n'a pas √©t√© trouv√© sur TMDB.`);
        return;
    }

    if(type !== result.type){
        alert(`‚ùå Erreur : "${title}" est un ${result.type}, pas une ${type}.`);
        return;
    }

    if(result.type==="S√©rie" && result.seasons>3 && code!=="AMIDEPASCAL"){
        alert("DEMANDE REJET√âE : Vous n'√™tes pas Premium !");
        togglePromoField(result.seasons);
        return;
    }

    togglePromoField(result.seasons);

    const requestData = {
        title: title,
        type: type,
        seasons: result.seasons,
        code: code==="AMIDEPASCAL"?"Premium": "Standard",
        date: new Date().toLocaleString()
    };

    saveRequestLocally(requestData);

    const phone = "22996326185";
    const message = `üé¨ *NOUVELLE DEMANDE CIN√âVERSE* üé¨%0A%0A`+
                    `üë§ *Nom:* ${name}%0A`+
                    `üìå *Type:* ${type}%0A`+
                    `üéûÔ∏è *Titre:* ${title}%0A`+
                    (code==="AMIDEPASCAL"?`üîë *Code:* ${code} (V√âRIFI√â ‚úÖ)%0A`:"")+
                    `%0A_Demande effectu√©e depuis le site web._`;
    window.open(`https://wa.me/${phone}?text=${message}`,'_blank');

    emailjs.send("service_7njbqib","template_dzcv9gj",{
        user_name: name,
        user_email: email,
        content_title: title,
        content_type: type,
        seasons: result.seasons,
        status: "Demande re√ßue !"
    }).then(()=>console.log("Email envoy√©"),err=>console.error(err));

    alert("‚úÖ Votre demande a √©t√© envoy√©e et un mail de confirmation vous a √©t√© envoy√© !");
});

document.getElementById("view_requests").addEventListener("click", showRequests);
</script>

</body>
</html>